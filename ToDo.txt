1. update partner db schema
2. monitor if delete happens
3. Id, date
4. SpB FK, bigint, staging
5. Sync with nsbTests 
6. look if table have been changed
7. create table in staging to look index_usage_stats => do nothing if not changed besides first time after restart after
timestamp!!
vsdbcmd.exe
sqlpackage.exe
DacFx

select sqlserver_start_time,* from sys.dm_os_sys_info

select OBJECT_NAME(indexes.object_id),last_user_update,last_system_update,* from  sys.indexes 
join sys.objects on indexes.object_id=objects.object_id 
join sys.dm_db_index_usage_stats as dms on dms.object_id=objects.object_id
ClickOnce manifest signing

update staging
schemasync!!! check before

update sync4partner.SyncTableOperational set 
UpdateConditionForSplit='(ISNULL([Table1Id])?ISNULL([Table1Id (1)]):[Table1Id]!=[Table1Id (1)])',
UpdateExpressonForOLECommand='update Table2 set [Text2]=s.[Text2],[Table1Id]=s.[Table1Id]  from staging.Table2 as s where s.id=table2.id; delete staging.Table2',
PackageName='Table2_FullJoin.dtsx'
where Name='table2'

!((ISNULL([Table1Id])?ISNULL([Table1Id (1)]):[Table1Id]==[Table1Id (1)]) && (ISNULL([text2])?ISNULL([text2 (1)]):[text2]==[text2 (1)]))
((ISNULL([text2])!=ISNULL([text2 (1)])) || ( (! ISNULL([text2]) && ! ISNULL([text2 (1)]) ) && ([text2] != [text2 (1)]) ))  || ((ISNULL([Table1Id])!=ISNULL([Table1Id (1)])) ||( ( ! ISNULL([Table1Id]) && ! ISNULL([Table1Id (1)])) && ([Table1Id] != [Table1Id (1)]) ))

SELECT CHECKSUM_AGG(BINARY_CHECKSUM(*)) FROM sample_table WITH (NOLOCK);

https://www.simple-talk.com/sql/database-administration/automated-script-generation-with-powershell-and-smo/
https://www.simple-talk.com/sql/database-delivery/microsoft-and-database-lifecycle-management-dlm-the-dacpac/
http://www.codeproject.com/Articles/1080452/Parameterize-Schema-Name-in-SSDT-Database-Project
https://blogs.msdn.microsoft.com/ssdt/2013/12/23/dacfx-public-model-tutorial/ !!!


on Drive
ssisctc-81799
ssismhash-98110




EXEC sp_msforeachtable 'ALTER TABLE ? NOCHECK CONSTRAINT all'

EXEC sp_msforeachtable 'ALTER TABLE ? CHECK CONSTRAINT all'

performance:
http://sqlmag.com/sql-server-integration-services/designing-ssis-packages-high-performance
BufferSizeTuning logging event

raw file source?
measure!



USE msdb ;  
GO  
EXEC dbo.sp_add_notification   
@alert_name = N'Test Alert',   
@operator_name = N'François Ajenstat',   
@notification_method = 1 ; 
or
http://www.databasejournal.com/features/mssql/setting-up-email-notification-for-ssis-package-failure.html



!!
select tName,cName,is_nullable,is_identity,cols.column_id,key_ordinal,iName,
CASE WHEN iName is null THEN 0 ELSE 1 END as is_primarykey,typeName
from 
(select distinct t.name tName,c.name cName,c.is_nullable,is_identity,c.column_id,t.object_id,types.name as typeName from sys.tables as t join sys.columns as c on t.object_id = c.object_id  join sys.schemas on t.schema_id=schemas.schema_id and schemas.name='dbo' join sys.types on c.user_type_id=types.user_type_id) as cols
left join
(select indexes.object_id,index_columns.column_id,key_ordinal,indexes.name as iName from sys.index_columns 
join sys.indexes on index_columns.object_id=indexes.object_id and indexes.is_primary_key=1 and indexes.index_id=index_columns.index_id) as pk
on pk.object_id=cols.object_id and pk.column_id=cols.column_id
order by tName
